<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-ajax/dist/leaflet.ajax.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
  <style>
    .container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .container div {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .log,
    .reg {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s ease;
    }

    .log {
      background-color: #fff;
      color: #000;
    }

    .reg {
      background-color: #000;
      color: #fff;
    }

    .log:hover {
      background-color: #000;
      color: #fff;
    }

    .reg:hover {
      background-color: #fff;
      color: #000;
    }

    .container p {
      color: #fff;
      font-size: 14px;
    }

    .container a {
      color: #fff;
      text-decoration: none;
      font-weight: bold;
    }

    .container span {
      color: red;
    }

    #menu {
      width: 250px;
      position: fixed;
      top: 0;
      left: 0;
      bottom: 0;
      z-index: 1001;
      background: #191818;
      overflow-y: auto;
      transition: all 0.3s ease;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
    }

    #main {
      margin-left: 250px;
      height: 100vh;
      transition: all 0.3s ease;
    }

    #map {
      width: 100%;
      height: 100%;
    }

    /*
    All anchors inside the menu should be styled like this.
    */
    #menu a {
      color: #999;
      border: none;
      padding: 0.6em 0 0.6em 0.6em;
    }

    /*
    Remove all background/borders, since we are applying them to #menu.
    */
    #menu .pure-menu,
    #menu .pure-menu ul {
      border: none;
      background: transparent;
    }

    /*
    Add that light border to separate items into groups.
    */
    #menu .pure-menu ul,
    #menu .pure-menu .menu-item-divided {
      border-top: 1px solid #333;
    }

    /*
        Change color of the anchor links on hover/focus.
        */
    #menu .pure-menu li a:hover,
    #menu .pure-menu li a:focus {
      background: #333;
    }

    /*
    This styles the selected menu item `<li>`.
    */
    #menu .pure-menu-selected,
    #menu .pure-menu-heading {
      background: #1f8dd6;
    }

    /*
        This styles a link within a selected menu item `<li>`.
        */
    #menu .pure-menu-selected a {
      color: #fff;
    }

    /*
    This styles the menu heading.
    */
    #menu .pure-menu-heading {
      font-size: 110%;
      color: #fff;
      margin: 0;
    }
  </style>
</head>

<body>
  <div id="menu">
    <div class="pure-menu">
      <a class="pure-menu-heading" href="#">Map Tools</a>

      <ul class="pure-menu-list">
        <li class="pure-menu-item pure-menu-selected">
          <a href="#" class="pure-menu-link" onclick="setMode('select')">Selection Mode</a>
        </li>
        <li class="pure-menu-item">
          <a href="#" class="pure-menu-link" onclick="setMode('draw')">Drawing Mode</a>
        </li>
        <li class="pure-menu-item menu-item-divided">
          <div style="padding: 10px; color: #999; font-size: 0.8em;">
            <strong>Selection Details</strong>
            <div id="selection-info" style="margin-top: 10px; color: #ccc;">
              Click a district to see details.
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <div id="main">
    <div id="map"></div>
    <div class="container ">
      <div>
        <button class="log">Login</button>
        <button class="reg">Sign up</button>
      </div>
    </div>
  </div>



  <script>
    var map = L.map('map').setView([11.1276, 78.6569], 7); // Center on Tamil Nadu, India

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var currentMode = 'select'; // Default mode
    var drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    var drawControl = new L.Control.Draw({
      edit: {
        featureGroup: drawnItems
      },
      draw: {
        polygon: true,
        polyline: true,
        rectangle: true,
        circle: true,
        marker: true
      }
    });

    // Function to set the active mode
    function setMode(mode) {
      currentMode = mode;

      // Update UI active state
      const menuItems = document.querySelectorAll('.pure-menu-item');
      menuItems.forEach(item => item.classList.remove('pure-menu-selected'));

      if (mode === 'draw') {
        map.addControl(drawControl);
        menuItems[1].classList.add('pure-menu-selected');
        document.getElementById('selection-info').innerHTML = 'Drawing mode active. Use the toolbar on the left of the map.';
      } else {
        map.removeControl(drawControl);
        menuItems[0].classList.add('pure-menu-selected');
        document.getElementById('selection-info').innerHTML = 'Select mode active. Click a district to see details.';
      }
    }

    // Default: Start in Selection mode (no draw control)
    // Actually, I initialized drawControl but I'll only add it if mode is draw.

    map.on(L.Draw.Event.CREATED, function (event) {
      var layer = event.layer;
      drawnItems.addLayer(layer);
    });

    // Load GeoJSON data
    var geojsonLayer = L.geoJSON.ajax('geojsonSource.json', {
      onEachFeature: function (feature, layer) {
        layer.on('click', function (e) {
          if (currentMode === 'select') {
            L.DomEvent.stopPropagation(e); // Prevent map click

            // Highlight feature
            geojsonLayer.resetStyle();
            layer.setStyle({
              weight: 5,
              color: '#666',
              dashArray: '',
              fillOpacity: 0.7
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
              layer.bringToFront();
            }

            // Update sidebar info
            document.getElementById('selection-info').innerHTML = `
              <strong>District:</strong> ${feature.properties.districtName}<br>
              <strong>Code:</strong> ${feature.properties.districtCode || 'N/A'}
            `;
          }
        });
      }
    }).addTo(map);

    // Initial UI state
    setMode('select');
  </script>
</body>

</html>